<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Pendataan Hewan PWA</title>
    <!-- Tambahkan setelah meta tags -->
    <link rel="manifest" href="manifest.json" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black" />
    <meta name="apple-mobile-web-app-title" content="Pendataan Hewan" />
    <!-- PWA Meta Tags -->
    <meta name="theme-color" content="#4F46E5" />
    <meta
      name="description"
      content="Aplikasi PWA untuk pendataan hewan dengan fitur barcode"
    />
    <link
      rel="manifest"
      href="data:application/json;base64,eyJuYW1lIjoiUGVuZGF0YWFuIEhld2FuIFBXQSIsInNob3J0X25hbWUiOiJIZXdhblBXQSIsImRlc2NyaXB0aW9uIjoiQXBsaWthc2kgUFdBIHVudHVrIHBlbmRhdGFhbiBoZXdhbiIsInN0YXJ0X3VybCI6Ii8iLCJkaXNwbGF5Ijoic3RhbmRhbG9uZSIsImJhY2tncm91bmRfY29sb3IiOiIjZmZmZmZmIiwidGhlbWVfY29sb3IiOiIjNEY0NkU1IiwiaWNvbnMiOlt7InNyYyI6ImRhdGE6aW1hZ2Uvc3ZnK3htbDtiYXNlNjQsUEhOMlp5QjNhV1IwYUQwaVpEUWlJR2hsYVdkb2REMGlaRFFpSUhabGNuTnBiMjQ5SWpFdU1TNHhJaUI0Yld4dWN6MGlhSFIwY0RvdkwzZDNkeTUzTXk1dmNtY3ZNakF3TUM5emRtY2lQaUE4Y0dGMGFDQmtQU0p0TVRCb05VRXhNR013TFRVdU5EQjJNalUySURVdU5EQXROUzQwTURoaE5TNDFPQ0ExTGpVNElEQXdNUzQxTVMwM0xqWXhNamt1T0RCaWFqUXVOemdnTkM0M09IcE5MVEp6TmpCd01UWmhPQzR3Tmlnd0xqQXhMakF6TGpBN05DNHdPU0F6TGpBNU5pNHpOeTR5TmpOc05UQXdOaTQyTmpoYU0yWjJOREl1TWpjM1lURXVOelExTVM0M05EVXpNVGt1TnpFNE1UazNMamt6Tm5rM0xqa3pMalkwTm1zek9EUXRNVEl1T1RZek1qUXRNVGt1TnpFNEluOCtQQzl6ZG1jKyIsInNpemVzIjoiNjR4NjQiLCJ0eXBlIjoiaW1hZ2Uvc3ZnK3htbCJ9XX0="
    />

    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        min-height: 100vh;
        color: #333;
      }

      .container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 20px;
      }

      .header {
        text-align: center;
        margin-bottom: 30px;
        color: white;
      }

      .header h1 {
        font-size: 2.5rem;
        margin-bottom: 10px;
        text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
      }

      .nav-tabs {
        display: flex;
        background: rgba(255, 255, 255, 0.1);
        border-radius: 15px;
        padding: 5px;
        margin-bottom: 30px;
        backdrop-filter: blur(10px);
      }

      .nav-tab {
        flex: 1;
        padding: 12px 20px;
        background: transparent;
        border: none;
        color: white;
        cursor: pointer;
        border-radius: 10px;
        transition: all 0.3s ease;
        font-weight: 500;
      }

      .nav-tab.active {
        background: white;
        color: #667eea;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
      }

      .tab-content {
        display: none;
        background: white;
        border-radius: 20px;
        padding: 30px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        backdrop-filter: blur(10px);
      }

      .tab-content.active {
        display: block;
        animation: fadeIn 0.3s ease;
      }

      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateY(20px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      .form-group {
        margin-bottom: 20px;
      }

      .form-group label {
        display: block;
        margin-bottom: 8px;
        font-weight: 600;
        color: #555;
      }

      .form-group input,
      .form-group select,
      .form-group textarea {
        width: 100%;
        padding: 12px 15px;
        border: 2px solid #e1e5e9;
        border-radius: 10px;
        font-size: 16px;
        transition: border-color 0.3s ease;
      }

      .form-group input:focus,
      .form-group select:focus,
      .form-group textarea:focus {
        outline: none;
        border-color: #667eea;
        box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
      }

      .btn {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        padding: 12px 30px;
        border: none;
        border-radius: 10px;
        cursor: pointer;
        font-size: 16px;
        font-weight: 600;
        transition: transform 0.2s ease;
        margin-right: 10px;
        margin-bottom: 10px;
      }

      .btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
      }

      .btn-secondary {
        background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
      }

      .search-box {
        position: relative;
        margin-bottom: 20px;
      }

      .search-box input {
        padding-left: 50px;
      }

      .search-icon {
        position: absolute;
        left: 15px;
        top: 50%;
        transform: translateY(-50%);
        color: #999;
      }

      .animal-card {
        background: linear-gradient(135deg, #f6f9fc 0%, #ffffff 100%);
        border-radius: 15px;
        padding: 20px;
        margin-bottom: 15px;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        transition: transform 0.2s ease;
      }

      .animal-card:hover {
        transform: translateY(-3px);
        box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
      }

      .animal-header {
        display: flex;
        justify-content: between;
        align-items: center;
        margin-bottom: 15px;
      }

      .animal-name {
        font-size: 1.5rem;
        font-weight: 700;
        color: #667eea;
      }

      .animal-species {
        color: #666;
        font-size: 1.1rem;
      }

      .animal-info {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 15px;
        margin-bottom: 15px;
      }

      .info-item {
        background: rgba(102, 126, 234, 0.1);
        padding: 10px 15px;
        border-radius: 8px;
      }

      .info-label {
        font-weight: 600;
        color: #555;
      }

      .info-value {
        color: #333;
        margin-top: 5px;
      }

      .barcode-container {
        text-align: center;
        padding: 20px;
        background: #f8f9fa;
        border-radius: 10px;
        margin-top: 15px;
      }

      .no-data {
        text-align: center;
        padding: 40px;
        color: #666;
      }

      /* Enhanced Search Styles */
      .search-header {
        text-align: center;
        margin-bottom: 30px;
      }

      .search-header h2 {
        font-size: 2rem;
        margin-bottom: 10px;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
      }

      .search-subtitle {
        color: #666;
        font-size: 1.1rem;
      }

      .search-methods-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 20px;
        margin-bottom: 30px;
      }

      .search-method-card {
        background: linear-gradient(135deg, #f8f9ff 0%, #ffffff 100%);
        border: 2px solid #e1e5e9;
        border-radius: 20px;
        padding: 25px;
        text-align: center;
        cursor: pointer;
        transition: all 0.3s ease;
        position: relative;
        overflow: hidden;
      }

      .search-method-card::before {
        content: "";
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(
          90deg,
          transparent,
          rgba(102, 126, 234, 0.1),
          transparent
        );
        transition: left 0.5s ease;
      }

      .search-method-card:hover::before {
        left: 100%;
      }

      .search-method-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 10px 30px rgba(102, 126, 234, 0.2);
        border-color: #667eea;
      }

      .search-method-card.active {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        border-color: #667eea;
        box-shadow: 0 8px 25px rgba(102, 126, 234, 0.3);
      }

      .method-icon {
        font-size: 3rem;
        margin-bottom: 15px;
        display: block;
      }

      .method-title {
        font-size: 1.3rem;
        font-weight: 700;
        margin-bottom: 10px;
      }

      .method-description {
        font-size: 0.9rem;
        opacity: 0.8;
        line-height: 1.4;
      }

      .search-content {
        margin-bottom: 30px;
      }

      .search-container {
        display: none;
        animation: slideIn 0.3s ease;
      }

      .search-container.active {
        display: block;
      }

      @keyframes slideIn {
        from {
          opacity: 0;
          transform: translateY(20px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      .search-input-wrapper {
        background: linear-gradient(135deg, #f8f9ff 0%, #ffffff 100%);
        border-radius: 20px;
        padding: 30px;
        box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
      }

      .search-input-container {
        position: relative;
        display: flex;
        align-items: center;
        gap: 10px;
      }

      .search-icon-wrapper {
        position: absolute;
        left: 20px;
        z-index: 2;
        font-size: 1.2rem;
      }

      .modern-input {
        flex: 1;
        padding: 18px 20px 18px 60px;
        border: none;
        border-radius: 15px;
        font-size: 16px;
        background: white;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        transition: all 0.3s ease;
      }

      .modern-input:focus {
        outline: none;
        box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.2),
          0 4px 20px rgba(0, 0, 0, 0.15);
        transform: translateY(-2px);
      }

      .search-clear {
        position: absolute;
        right: 20px;
        cursor: pointer;
        background: #f1f3f4;
        border-radius: 50%;
        width: 24px;
        height: 24px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 14px;
        transition: all 0.2s ease;
      }

      .search-clear:hover {
        background: #e8eaed;
        transform: scale(1.1);
      }

      .search-btn {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        border: none;
        padding: 18px 30px;
        border-radius: 15px;
        font-weight: 600;
        cursor: pointer;
        position: relative;
        overflow: hidden;
        transition: all 0.3s ease;
      }

      .search-btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
      }

      .btn-ripple {
        position: absolute;
        top: 50%;
        left: 50%;
        width: 0;
        height: 0;
        border-radius: 50%;
        background: rgba(255, 255, 255, 0.3);
        transform: translate(-50%, -50%);
        transition: width 0.3s ease, height 0.3s ease;
      }

      .search-btn:active .btn-ripple {
        width: 100px;
        height: 100px;
      }

      .search-suggestions {
        margin-top: 20px;
        text-align: center;
      }

      .suggestion-label {
        color: #666;
        font-size: 0.9rem;
        margin-bottom: 10px;
        display: block;
      }

      .suggestion-tags {
        display: flex;
        flex-wrap: wrap;
        gap: 8px;
        justify-content: center;
      }

      .suggestion-tag {
        background: rgba(102, 126, 234, 0.1);
        color: #667eea;
        padding: 8px 15px;
        border-radius: 20px;
        font-size: 0.85rem;
        cursor: pointer;
        transition: all 0.2s ease;
      }

      .suggestion-tag:hover {
        background: #667eea;
        color: white;
        transform: translateY(-2px);
      }

      .id-search-card,
      .barcode-scanner-card {
        background: white;
        border-radius: 20px;
        overflow: hidden;
      }

      .card-header {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        padding: 25px;
        text-align: center;
      }

      .card-header h3 {
        margin-bottom: 8px;
        font-size: 1.5rem;
      }

      .card-header p {
        opacity: 0.9;
        font-size: 1rem;
      }

      .id-examples,
      .barcode-examples {
        margin-top: 15px;
        text-align: center;
        color: #666;
      }

      .example-label {
        font-weight: 600;
        margin-right: 10px;
      }

      .example-id,
      .example-code {
        background: rgba(102, 126, 234, 0.1);
        color: #667eea;
        padding: 4px 10px;
        border-radius: 8px;
        font-family: monospace;
        margin: 0 5px;
      }

      .scanner-section {
        padding: 25px;
      }

      .scanner-controls {
        display: flex;
        gap: 15px;
        justify-content: center;
        margin-bottom: 20px;
        flex-wrap: wrap;
      }

      .scanner-btn {
        display: flex;
        align-items: center;
        gap: 10px;
        padding: 15px 25px;
        border: none;
        border-radius: 15px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
      }

      .scanner-btn.primary {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
      }

      .scanner-btn.secondary {
        background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        color: white;
      }

      .scanner-btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
      }

      .scanner-viewport {
        display: none;
        margin: 20px 0;
      }

      .scanner-frame {
        position: relative;
        max-width: 400px;
        margin: 0 auto;
        border-radius: 15px;
        overflow: hidden;
        box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
      }

      #video {
        width: 100%;
        height: 300px;
        object-fit: cover;
        background: #000;
      }

      .scanner-overlay {
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(0, 0, 0, 0.3);
        display: flex;
        align-items: center;
        justify-content: center;
      }

      .scanner-line {
        width: 80%;
        height: 2px;
        background: #00ff00;
        box-shadow: 0 0 10px #00ff00;
        animation: scanLine 2s linear infinite;
      }

      @keyframes scanLine {
        0%,
        100% {
          opacity: 0;
        }
        50% {
          opacity: 1;
        }
      }

      .scanner-corners {
        position: absolute;
        top: 20px;
        left: 20px;
        right: 20px;
        bottom: 20px;
      }

      .corner {
        position: absolute;
        width: 30px;
        height: 30px;
        border: 3px solid #00ff00;
      }

      .corner.top-left {
        top: 0;
        left: 0;
        border-right: none;
        border-bottom: none;
      }

      .corner.top-right {
        top: 0;
        right: 0;
        border-left: none;
        border-bottom: none;
      }

      .corner.bottom-left {
        bottom: 0;
        left: 0;
        border-right: none;
        border-top: none;
      }

      .corner.bottom-right {
        bottom: 0;
        right: 0;
        border-left: none;
        border-top: none;
      }

      .scanner-instruction {
        text-align: center;
        margin-top: 15px;
        color: #666;
        font-style: italic;
      }

      .scan-result-card {
        display: none;
        margin: 20px 25px;
        padding: 20px;
        border-radius: 15px;
        text-align: center;
      }

      .section-divider {
        position: relative;
        text-align: center;
        margin: 30px 0;
      }

      .section-divider::before {
        content: "";
        position: absolute;
        top: 50%;
        left: 0;
        right: 0;
        height: 1px;
        background: #e1e5e9;
      }

      .divider-text {
        background: white;
        padding: 0 20px;
        color: #666;
        font-weight: 600;
        position: relative;
      }

      .manual-input-section {
        padding: 0 25px 25px;
      }

      .manual-input-card h4 {
        text-align: center;
        margin-bottom: 20px;
        color: #333;
      }

      .search-results-container {
        margin-top: 30px;
      }

      @media (max-width: 768px) {
        .search-methods-grid {
          grid-template-columns: 1fr;
        }

        .scanner-controls {
          flex-direction: column;
          align-items: center;
        }

        .scanner-btn {
          width: 100%;
          max-width: 250px;
        }

        .suggestion-tags {
          justify-content: flex-start;
        }
      }

      .stats-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 20px;
        margin-bottom: 30px;
      }

      .stat-card {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        padding: 25px;
        border-radius: 15px;
        text-align: center;
        box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
      }

      .stat-number {
        font-size: 2.5rem;
        font-weight: 700;
        margin-bottom: 5px;
      }

      .stat-label {
        font-size: 1rem;
        opacity: 0.9;
      }

      @media (max-width: 768px) {
        .container {
          padding: 15px;
        }

        .header h1 {
          font-size: 2rem;
        }

        .nav-tabs {
          flex-direction: column;
        }

        .nav-tab {
          margin-bottom: 5px;
        }

        .animal-info {
          grid-template-columns: 1fr;
        }
      }
    </style>
  </head>
  <body>
    <div class="container">
      <div class="header">
        <h1>🐾 Pendataan Hewan</h1>
        <p>Sistem manajemen data hewan dengan barcode</p>
      </div>

      <div class="nav-tabs">
        <button class="nav-tab active" onclick="showTab('dashboard')">
          Dashboard
        </button>
        <button class="nav-tab" onclick="showTab('add')">Tambah Hewan</button>
        <button class="nav-tab" onclick="showTab('search')">Pencarian</button>
        <button class="nav-tab" onclick="showTab('list')">Daftar Hewan</button>
      </div>

      <!-- Dashboard Tab -->
      <div id="dashboard" class="tab-content active">
        <h2>Dashboard</h2>
        <div class="stats-grid">
          <div class="stat-card">
            <div class="stat-number" id="totalAnimals">0</div>
            <div class="stat-label">Total Hewan</div>
          </div>
          <div class="stat-card">
            <div class="stat-number" id="totalSpecies">0</div>
            <div class="stat-label">Jenis Spesies</div>
          </div>
          <div class="stat-card">
            <div class="stat-number" id="totalMale">0</div>
            <div class="stat-label">Jantan</div>
          </div>
          <div class="stat-card">
            <div class="stat-number" id="totalFemale">0</div>
            <div class="stat-label">Betina</div>
          </div>
        </div>
        <p>
          Selamat datang di sistem pendataan hewan. Gunakan menu di atas untuk
          mengelola data hewan Anda.
        </p>
      </div>

      <!-- Add Animal Tab -->
      <div id="add" class="tab-content">
        <h2>Tambah Data Hewan</h2>
        <form id="animalForm">
          <div class="form-group">
            <label for="name">Nama Hewan *</label>
            <input type="text" id="name" required />
          </div>

          <div class="form-group">
            <label for="species">Spesies *</label>
            <input type="text" id="species" required />
          </div>

          <div class="form-group">
            <label for="breed">Ras/Breed</label>
            <input type="text" id="breed" />
          </div>

          <div class="form-group">
            <label for="gender">Jenis Kelamin *</label>
            <select id="gender" required>
              <option value="">Pilih Jenis Kelamin</option>
              <option value="Jantan">Jantan</option>
              <option value="Betina">Betina</option>
            </select>
          </div>

          <div class="form-group">
            <label for="age">Umur (bulan)</label>
            <input type="number" id="age" min="0" />
          </div>

          <div class="form-group">
            <label for="weight">Berat (kg)</label>
            <input type="number" id="weight" step="0.1" min="0" />
          </div>

          <div class="form-group">
            <label for="color">Warna</label>
            <input type="text" id="color" />
          </div>

          <div class="form-group">
            <label for="health">Status Kesehatan</label>
            <select id="health">
              <option value="">Pilih Status</option>
              <option value="Sehat">Sehat</option>
              <option value="Sakit">Sakit</option>
              <option value="Pemulihan">Pemulihan</option>
            </select>
          </div>

          <div class="form-group">
            <label for="location">Lokasi</label>
            <input type="text" id="location" />
          </div>

          <div class="form-group">
            <label for="notes">Catatan</label>
            <textarea id="notes" rows="3"></textarea>
          </div>

          <button type="submit" class="btn">Simpan Data</button>
          <button type="reset" class="btn btn-secondary">Reset Form</button>
        </form>
      </div>

      <!-- Search Tab -->
      <div id="search" class="tab-content">
        <div class="search-header">
          <h2>🔎 Pencarian Hewan</h2>
          <p class="search-subtitle">
            Temukan hewan dengan berbagai metode pencarian
          </p>
        </div>

        <!-- Search Methods Cards -->
        <div class="search-methods-grid">
          <div
            class="search-method-card active"
            onclick="switchSearchMethod('text')"
          >
            <div class="method-icon">🔍</div>
            <div class="method-title">Pencarian Teks</div>
            <div class="method-description">
              Cari berdasarkan nama, spesies, atau atribut lainnya
            </div>
          </div>
          <div class="search-method-card" onclick="switchSearchMethod('id')">
            <div class="method-icon">🏷️</div>
            <div class="method-title">Input ID</div>
            <div class="method-description">Cari hewan dengan ID spesifik</div>
          </div>
          <div
            class="search-method-card"
            onclick="switchSearchMethod('barcode')"
          >
            <div class="method-icon">📱</div>
            <div class="method-title">Scan Barcode</div>
            <div class="method-description">
              Gunakan kamera atau input manual
            </div>
          </div>
        </div>

        <!-- Search Containers -->
        <div class="search-content">
          <!-- Text Search -->
          <div id="textSearch" class="search-container active">
            <div class="search-input-wrapper">
              <div class="search-input-container">
                <div class="search-icon-wrapper">
                  <span class="search-icon">🔍</span>
                </div>
                <input
                  type="text"
                  id="searchInput"
                  placeholder="Ketik nama hewan, spesies, ras, lokasi, atau warna..."
                  class="modern-input"
                />
                <div
                  class="search-clear"
                  onclick="clearSearch()"
                  style="display: none"
                >
                  ✕
                </div>
              </div>
              <div class="search-suggestions">
                <span class="suggestion-label">Saran pencarian:</span>
                <div class="suggestion-tags">
                  <span class="suggestion-tag" onclick="quickSearch('kucing')"
                    >Kucing</span
                  >
                  <span class="suggestion-tag" onclick="quickSearch('anjing')"
                    >Anjing</span
                  >
                  <span class="suggestion-tag" onclick="quickSearch('sehat')"
                    >Status Sehat</span
                  >
                  <span class="suggestion-tag" onclick="quickSearch('jantan')"
                    >Jantan</span
                  >
                  <span class="suggestion-tag" onclick="quickSearch('betina')"
                    >Betina</span
                  >
                </div>
              </div>
            </div>
          </div>

          <!-- ID Search -->
          <div id="idSearch" class="search-container">
            <div class="search-input-wrapper">
              <div class="id-search-card">
                <div class="card-header">
                  <h3>🏷️ Pencarian berdasarkan ID</h3>
                  <p>Masukkan ID unik hewan untuk pencarian cepat</p>
                </div>
                <div class="search-input-container">
                  <div class="search-icon-wrapper">
                    <span class="search-icon">🏷️</span>
                  </div>
                  <input
                    type="number"
                    id="idInput"
                    placeholder="Contoh: 1, 2, 3..."
                    class="modern-input"
                    min="1"
                  />
                  <button class="search-btn" onclick="searchById()">
                    <span>Cari</span>
                    <div class="btn-ripple"></div>
                  </button>
                </div>
                <div class="id-examples">
                  <span class="example-label">ID Terakhir:</span>
                  <span class="example-id" id="lastIdExample">-</span>
                </div>
              </div>
            </div>
          </div>

          <!-- Barcode Scanner -->
          <div id="barcodeSearch" class="search-container">
            <div class="search-input-wrapper">
              <div class="barcode-scanner-card">
                <div class="card-header">
                  <h3>📱 Scanner Barcode</h3>
                  <p>Scan barcode atau masukkan kode secara manual</p>
                </div>

                <!-- Camera Scanner Section -->
                <div class="scanner-section">
                  <div class="scanner-controls">
                    <button
                      class="scanner-btn primary"
                      onclick="startBarcodeScanner()"
                    >
                      <span class="btn-icon">📷</span>
                      <span>Mulai Scan Kamera</span>
                    </button>
                    <button
                      class="scanner-btn secondary"
                      onclick="stopBarcodeScanner()"
                    >
                      <span class="btn-icon">⏹️</span>
                      <span>Stop Scanner</span>
                    </button>
                  </div>

                  <div id="scannerContainer" class="scanner-viewport">
                    <div class="scanner-frame">
                      <video id="video" autoplay playsinline></video>
                      <div class="scanner-overlay">
                        <div class="scanner-line"></div>
                        <div class="scanner-corners">
                          <div class="corner top-left"></div>
                          <div class="corner top-right"></div>
                          <div class="corner bottom-left"></div>
                          <div class="corner bottom-right"></div>
                        </div>
                      </div>
                    </div>
                    <canvas id="canvas" style="display: none"></canvas>
                    <p class="scanner-instruction">
                      Arahkan kamera ke barcode dan tunggu hingga terdeteksi
                    </p>
                  </div>
                </div>

                <!-- Scan Result -->
                <div id="scanResult" class="scan-result-card"></div>

                <!-- Manual Input Section -->
                <div class="manual-input-section">
                  <div class="section-divider">
                    <span class="divider-text">atau</span>
                  </div>

                  <div class="manual-input-card">
                    <h4>📊 Input Manual Barcode</h4>
                    <div class="search-input-container">
                      <div class="search-icon-wrapper">
                        <span class="search-icon">📊</span>
                      </div>
                      <input
                        type="text"
                        id="barcodeInput"
                        placeholder="Masukkan 8 digit kode barcode..."
                        class="modern-input"
                        maxlength="8"
                      />
                      <button class="search-btn" onclick="searchByBarcode()">
                        <span>Cari</span>
                        <div class="btn-ripple"></div>
                      </button>
                    </div>
                    <div class="barcode-examples">
                      <span class="example-label">Format:</span>
                      <span class="example-code">00000001</span>
                      <span class="example-code">00000023</span>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Search Results -->
        <div id="searchResults" class="search-results-container"></div>
      </div>

      <!-- List Tab -->
      <div id="list" class="tab-content">
        <h2>Daftar Semua Hewan</h2>
        <div id="animalList"></div>
      </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jsbarcode/3.11.5/JsBarcode.all.min.js"></script>
    <script>
      // Data storage
      let animals = JSON.parse(localStorage.getItem("animals") || "[]");
      let currentId = parseInt(localStorage.getItem("currentId") || "1");

      // Tab functionality
      function showTab(tabName) {
        // Hide all tabs
        document.querySelectorAll(".tab-content").forEach((tab) => {
          tab.classList.remove("active");
        });
        document.querySelectorAll(".nav-tab").forEach((tab) => {
          tab.classList.remove("active");
        });

        // Show selected tab
        document.getElementById(tabName).classList.add("active");
        event.target.classList.add("active");

        // Load data for specific tabs
        if (tabName === "list") {
          displayAllAnimals();
        } else if (tabName === "dashboard") {
          updateDashboard();
        }
      }

      // Generate unique ID
      function generateId() {
        return currentId++;
      }

      // Save data to localStorage
      function saveData() {
        localStorage.setItem("animals", JSON.stringify(animals));
        localStorage.setItem("currentId", currentId.toString());
      }

      // Add animal form handler
      document
        .getElementById("animalForm")
        .addEventListener("submit", function (e) {
          e.preventDefault();

          const animal = {
            id: generateId(),
            name: document.getElementById("name").value,
            species: document.getElementById("species").value,
            breed: document.getElementById("breed").value,
            gender: document.getElementById("gender").value,
            age: parseInt(document.getElementById("age").value) || 0,
            weight: parseFloat(document.getElementById("weight").value) || 0,
            color: document.getElementById("color").value,
            health: document.getElementById("health").value,
            location: document.getElementById("location").value,
            notes: document.getElementById("notes").value,
            dateAdded: new Date().toLocaleDateString("id-ID"),
          };

          animals.push(animal);
          saveData();

          alert("Data hewan berhasil ditambahkan!");
          this.reset();
          updateDashboard();
        });

      // Generate barcode
      function generateBarcode(animalId) {
        const canvas = document.createElement("canvas");
        JsBarcode(canvas, animalId.toString().padStart(8, "0"), {
          format: "CODE128",
          width: 2,
          height: 100,
          displayValue: true,
        });
        return canvas;
      }

      // Display animal card
      function displayAnimalCard(animal) {
        const barcodeCanvas = generateBarcode(animal.id);

        return `
                <div class="animal-card">
                    <div class="animal-header">
                        <div>
                            <div class="animal-name">${animal.name}</div>
                            <div class="animal-species">${animal.species}</div>
                        </div>
                    </div>
                    
                    <div class="animal-info">
                        <div class="info-item">
                            <div class="info-label">ID</div>
                            <div class="info-value">${animal.id
                              .toString()
                              .padStart(6, "0")}</div>
                        </div>
                        <div class="info-item">
                            <div class="info-label">Ras/Breed</div>
                            <div class="info-value">${animal.breed || "-"}</div>
                        </div>
                        <div class="info-item">
                            <div class="info-label">Jenis Kelamin</div>
                            <div class="info-value">${animal.gender}</div>
                        </div>
                        <div class="info-item">
                            <div class="info-label">Umur</div>
                            <div class="info-value">${animal.age} bulan</div>
                        </div>
                        <div class="info-item">
                            <div class="info-label">Berat</div>
                            <div class="info-value">${animal.weight} kg</div>
                        </div>
                        <div class="info-item">
                            <div class="info-label">Warna</div>
                            <div class="info-value">${animal.color || "-"}</div>
                        </div>
                        <div class="info-item">
                            <div class="info-label">Status Kesehatan</div>
                            <div class="info-value">${
                              animal.health || "-"
                            }</div>
                        </div>
                        <div class="info-item">
                            <div class="info-label">Lokasi</div>
                            <div class="info-value">${
                              animal.location || "-"
                            }</div>
                        </div>
                    </div>
                    
                    ${
                      animal.notes
                        ? `<div class="info-item"><div class="info-label">Catatan</div><div class="info-value">${animal.notes}</div></div>`
                        : ""
                    }
                    
                    <div class="barcode-container">
                        <h4>Barcode</h4>
                        <div id="barcode-${animal.id}"></div>
                        <button class="btn" onclick="downloadBarcode(${
                          animal.id
                        }, '${animal.name}')">Download Barcode</button>
                        <button class="btn btn-secondary" onclick="deleteAnimal(${
                          animal.id
                        })">Hapus</button>
                    </div>
                </div>
            `;
      }

      // Display all animals
      function displayAllAnimals() {
        const container = document.getElementById("animalList");

        if (animals.length === 0) {
          container.innerHTML =
            '<div class="no-data">Belum ada data hewan yang ditambahkan.</div>';
          return;
        }

        container.innerHTML = animals
          .map((animal) => displayAnimalCard(animal))
          .join("");

        // Generate barcodes after DOM is updated
        animals.forEach((animal) => {
          const barcodeContainer = document.getElementById(
            `barcode-${animal.id}`
          );
          if (barcodeContainer) {
            barcodeContainer.appendChild(generateBarcode(animal.id));
          }
        });
      }

      // Search functionality
      document
        .getElementById("searchInput")
        .addEventListener("input", function () {
          const query = this.value.toLowerCase();
          searchAnimals(query);
        });

      // Enhanced search function
      function searchAnimals(query) {
        const results = animals.filter(
          (animal) =>
            animal.name.toLowerCase().includes(query) ||
            animal.species.toLowerCase().includes(query) ||
            animal.id.toString().includes(query) ||
            (animal.breed && animal.breed.toLowerCase().includes(query)) ||
            (animal.location &&
              animal.location.toLowerCase().includes(query)) ||
            (animal.color && animal.color.toLowerCase().includes(query))
        );

        displaySearchResults(results, query);
      }

      // Display search results
      function displaySearchResults(results, query = "") {
        const container = document.getElementById("searchResults");

        if (query === "") {
          container.innerHTML =
            '<div class="no-data">Masukkan kata kunci pencarian.</div>';
          return;
        }

        if (results.length === 0) {
          container.innerHTML =
            '<div class="no-data">Tidak ada hasil yang ditemukan.</div>';
          return;
        }

        container.innerHTML = `
                <div style="margin-bottom: 20px; padding: 15px; background: rgba(102, 126, 234, 0.1); border-radius: 10px; color: #333;">
                    <strong>Ditemukan ${results.length} hasil</strong>
                </div>
                ${results.map((animal) => displayAnimalCard(animal)).join("")}
            `;

        // Generate barcodes for search results
        results.forEach((animal) => {
          const barcodeContainer = document.getElementById(
            `barcode-${animal.id}`
          );
          if (barcodeContainer) {
            barcodeContainer.appendChild(generateBarcode(animal.id));
          }
        });
      }

      // Switch search method
      function switchSearchMethod(method) {
        // Update active button
        document.querySelectorAll(".search-method-btn").forEach((btn) => {
          btn.classList.remove("active");
        });
        event.target.classList.add("active");

        // Hide all search containers
        document.querySelectorAll(".search-container").forEach((container) => {
          container.style.display = "none";
        });

        // Show selected search container
        document.getElementById(method + "Search").style.display = "block";

        // Clear previous results
        document.getElementById("searchResults").innerHTML =
          '<div class="no-data">Pilih metode pencarian dan masukkan kata kunci.</div>';
      }

      // Search by ID
      function searchById() {
        const idInput = document.getElementById("idInput");
        const searchId = parseInt(idInput.value);

        if (!searchId) {
          alert("Masukkan ID yang valid!");
          return;
        }

        const result = animals.find((animal) => animal.id === searchId);

        if (result) {
          displaySearchResults([result], searchId.toString());
        } else {
          document.getElementById(
            "searchResults"
          ).innerHTML = `<div class="no-data">Hewan dengan ID ${searchId} tidak ditemukan.</div>`;
        }
      }

      // Barcode scanner variables
      let video = null;
      let canvas = null;
      let context = null;
      let scanning = false;

      // Start barcode scanner
      async function startBarcodeScanner() {
        const scannerContainer = document.getElementById("scannerContainer");
        const scanResult = document.getElementById("scanResult");

        video = document.getElementById("video");
        canvas = document.getElementById("canvas");
        context = canvas.getContext("2d");

        try {
          // Request camera permission
          const stream = await navigator.mediaDevices.getUserMedia({
            video: {
              width: { ideal: 1280 },
              height: { ideal: 720 },
              facingMode: "environment", // Use back camera if available
            },
          });

          video.srcObject = stream;
          video.play();
          scanning = true;

          scannerContainer.style.display = "block";
          scanResult.style.display = "none";

          // Start scanning process
          scanBarcode();
        } catch (error) {
          console.error("Error accessing camera:", error);
          document.getElementById(
            "searchResults"
          ).innerHTML = `<div class="camera-permission">
                        <strong>⚠️ Tidak dapat mengakses kamera</strong><br>
                        Pastikan Anda telah memberikan izin kamera atau gunakan input manual di bawah.
                    </div>`;
        }
      }

      // Stop barcode scanner
      function stopBarcodeScanner() {
        scanning = false;

        if (video && video.srcObject) {
          const tracks = video.srcObject.getTracks();
          tracks.forEach((track) => track.stop());
          video.srcObject = null;
        }

        document.getElementById("scannerContainer").style.display = "none";
        document.getElementById("scanResult").style.display = "none";
      }

      // Scan barcode from video
      function scanBarcode() {
        if (!scanning || !video) return;

        // Set canvas size to match video
        canvas.width = video.videoWidth;
        canvas.height = video.videoHeight;

        // Draw video frame to canvas
        context.drawImage(video, 0, 0, canvas.width, canvas.height);

        // Get image data
        const imageData = context.getImageData(
          0,
          0,
          canvas.width,
          canvas.height
        );

        // Try to decode barcode (simplified - in real app you'd use a proper barcode library)
        // For demo purposes, we'll use a timeout to simulate scanning

        // Continue scanning
        if (scanning) {
          requestAnimationFrame(scanBarcode);
        }
      }

      // Search by barcode (manual input)
      function searchByBarcode() {
        const barcodeInput = document.getElementById("barcodeInput");
        let barcodeValue = barcodeInput.value.trim();

        if (!barcodeValue) {
          alert("Masukkan kode barcode!");
          return;
        }

        // If barcode is 8 digits, treat as ID with leading zeros
        if (barcodeValue.length === 8 && /^\d+$/.test(barcodeValue)) {
          const searchId = parseInt(barcodeValue);
          const result = animals.find((animal) => animal.id === searchId);

          if (result) {
            displaySearchResults([result], barcodeValue);

            // Show scan result
            const scanResult = document.getElementById("scanResult");
            scanResult.innerHTML = `
                        <div style="color: #28a745;">
                            <strong>✅ Barcode berhasil dipindai!</strong><br>
                            Kode: ${barcodeValue}<br>
                            Ditemukan: ${result.name}
                        </div>
                    `;
            scanResult.style.display = "block";
          } else {
            document.getElementById(
              "searchResults"
            ).innerHTML = `<div class="no-data">Hewan dengan barcode ${barcodeValue} tidak ditemukan.</div>`;

            const scanResult = document.getElementById("scanResult");
            scanResult.innerHTML = `
                        <div style="color: #dc3545;">
                            <strong>❌ Barcode tidak ditemukan</strong><br>
                            Kode: ${barcodeValue}
                        </div>
                    `;
            scanResult.style.display = "block";
          }
        } else {
          alert("Format barcode tidak valid! Gunakan 8 digit angka.");
        }

        barcodeInput.value = "";
      }

      // ID Input enter key handler
      document
        .getElementById("idInput")
        .addEventListener("keypress", function (e) {
          if (e.key === "Enter") {
            searchById();
          }
        });

      // Barcode Input enter key handler
      document
        .getElementById("barcodeInput")
        .addEventListener("keypress", function (e) {
          if (e.key === "Enter") {
            searchByBarcode();
          }
        });

      // Download barcode
      function downloadBarcode(animalId, animalName) {
        const canvas = generateBarcode(animalId);
        const link = document.createElement("a");
        link.download = `barcode-${animalName}-${animalId}.png`;
        link.href = canvas.toDataURL();
        link.click();
      }

      // Delete animal
      function deleteAnimal(animalId) {
        if (confirm("Apakah Anda yakin ingin menghapus data hewan ini?")) {
          animals = animals.filter((animal) => animal.id !== animalId);
          saveData();
          displayAllAnimals();
          updateDashboard();
          alert("Data hewan berhasil dihapus!");
        }
      }

      // Update dashboard statistics
      function updateDashboard() {
        document.getElementById("totalAnimals").textContent = animals.length;

        const species = [...new Set(animals.map((animal) => animal.species))];
        document.getElementById("totalSpecies").textContent = species.length;

        const maleCount = animals.filter(
          (animal) => animal.gender === "Jantan"
        ).length;
        document.getElementById("totalMale").textContent = maleCount;

        const femaleCount = animals.filter(
          (animal) => animal.gender === "Betina"
        ).length;
        document.getElementById("totalFemale").textContent = femaleCount;
      }

      // Initialize app
      document.addEventListener("DOMContentLoaded", function () {
        updateDashboard();

        // Register service worker for PWA
        if ("serviceWorker" in navigator) {
          navigator.serviceWorker
            .register("./sw.js")
            .then(function (registration) {
              console.log(
                "Service Worker registered successfully:",
                registration.scope
              );
            })
            .catch(function (error) {
              console.log("Service Worker registration failed:", error);
            });
        }
      });
    </script>
  </body>
</html>
