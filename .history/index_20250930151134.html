<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Pendataan Hewan PWA</title>

    <!-- PWA Meta Tags -->
    <link rel="manifest" href="manifest.json" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black" />
    <meta name="apple-mobile-web-app-title" content="Pendataan Hewan" />
    <meta name="theme-color" content="#4F46E5" />
    <meta
      name="description"
      content="Aplikasi PWA untuk pendataan hewan dengan fitur barcode"
    />

    <!-- CSS -->
    <link rel="stylesheet" href="assets/css/style.css" />
  </head>
  <body>
    <div class="container">
      <div class="header">
        <h1>ğŸ¾ Pendataan Hewan</h1>
        <p>Sistem manajemen data hewan dengan barcode</p>
      </div>

      <div class="nav-tabs">
        <button class="nav-tab active" onclick="showTab('dashboard')">
          ğŸ“Š Dashboard
        </button>
        <button class="nav-tab" onclick="showTab('pendataan')">
          ğŸ“ Pendataan
        </button>
        <button class="nav-tab" onclick="showTab('perawatan')">
          ğŸ¥ Perawatan
        </button>
        <button class="nav-tab" onclick="showTab('monitoring')">
          ğŸ“ˆ Monitoring
        </button>
        <button class="nav-tab" onclick="showTab('panen')">
          ğŸŒ¾ Panen
        </button>
        <button class="nav-tab" onclick="showTab('evaluasi')">
          ğŸ“‹ Evaluasi
        </button>
      </div>

      <!-- Dashboard Tab -->
      <div id="dashboard" class="tab-content active">
        <div class="dashboard-header">
          <h2>ğŸ  Dashboard KPI Peternakan</h2>
          <p>Pantau performa peternakan Anda secara real-time</p>
        </div>
        
        <!-- KPI Cards -->
        <div class="kpi-grid">
          <div class="kpi-card primary">
            <div class="kpi-icon">ğŸ„</div>
            <div class="kpi-info">
              <div class="kpi-number" id="totalAnimals">0</div>
              <div class="kpi-label">Total Hewan</div>
            </div>
          </div>
          <div class="kpi-card success">
            <div class="kpi-icon">ğŸ’š</div>
            <div class="kpi-info">
              <div class="kpi-number" id="healthyAnimals">0</div>
              <div class="kpi-label">Hewan Sehat</div>
            </div>
          </div>
          <div class="kpi-card warning">
            <div class="kpi-icon">â°</div>
            <div class="kpi-info">
              <div class="kpi-number" id="scheduledCare">0</div>
              <div class="kpi-label">Perawatan Terjadwal</div>
            </div>
          </div>
          <div class="kpi-card info">
            <div class="kpi-icon">ğŸ“ˆ</div>
            <div class="kpi-info">
              <div class="kpi-number" id="avgGrowth">0%</div>
              <div class="kpi-label">Rata-rata Pertumbuhan</div>
            </div>
          </div>
          <div class="kpi-card secondary">
            <div class="kpi-icon">ğŸŒ¾</div>
            <div class="kpi-info">
              <div class="kpi-number" id="readyHarvest">0</div>
              <div class="kpi-label">Siap Panen</div>
            </div>
          </div>
          <div class="kpi-card accent">
            <div class="kpi-icon">ğŸ’°</div>
            <div class="kpi-info">
              <div class="kpi-number" id="monthlyRevenue">Rp 0</div>
              <div class="kpi-label">Pendapatan Bulan Ini</div>
            </div>
          </div>
        </div>

        <!-- Quick Actions -->
        <div class="quick-actions">
          <h3>ğŸš€ Aksi Cepat</h3>
          <div class="action-buttons">
            <button class="action-btn" onclick="showTab('pendataan')">
              â• Tambah Hewan Baru
            </button>
            <button class="action-btn" onclick="showTab('perawatan')">
              ğŸ’‰ Jadwal Perawatan
            </button>
            <button class="action-btn" onclick="showTab('monitoring')">
              ğŸ“ Input Data Pertumbuhan
            </button>
            <button class="action-btn" onclick="showTab('panen')">
              ğŸ“¦ Catat Hasil Panen
            </button>
          </div>
        </div>

        <!-- Recent Activities -->
        <div class="recent-activities">
          <h3>ğŸ“ Aktivitas Terbaru</h3>
          <div id="recentActivities" class="activity-list">
            <div class="no-data">Belum ada aktivitas terbaru</div>
          </div>
        </div>
      </div>

      <!-- Pendataan Hewan Tab -->
      <div id="pendataan" class="tab-content">
        <div class="module-header">
          <h2>ğŸ“ Pendataan Hewan</h2>
          <p>Registrasi dan manajemen data hewan ternak yang komprehensif</p>
        </div>

        <div class="pendataan-tabs">
          <button class="sub-tab active" onclick="showSubTab('registrasi')">
            â• Registrasi Hewan Baru
          </button>
          <button class="sub-tab" onclick="showSubTab('manajemen')">
            ğŸ“‹ Manajemen Data
          </button>
          <button class="sub-tab" onclick="showSubTab('pencarian')">
            ğŸ” Pencarian & Filter
          </button>
        </div>

        <!-- Registrasi Sub Tab -->
        <div id="registrasi" class="sub-content active">
          <div class="form-sections">
            <!-- Identifikasi Section -->
            <div class="form-section">
              <h3>ğŸ·ï¸ Identifikasi Hewan</h3>
              <form id="animalForm">
                <div class="form-row">
                  <div class="form-group">
                    <label for="animalId">ID Hewan (Auto Generated)</label>
                    <input type="text" id="animalId" readonly />
                  </div>
                  <div class="form-group">
                    <label for="qrCode">QR Code</label>
                    <div class="qr-generator">
                      <button type="button" onclick="generateQRCode()" class="btn-small">
                        ğŸ“± Generate QR
                      </button>
                      <div id="qrDisplay"></div>
                    </div>
                  </div>
                </div>
                
                <div class="form-row">
                  <div class="form-group">
                    <label for="name">Nama Hewan *</label>
                    <input type="text" id="name" required />
                  </div>
                  <div class="form-group">
                    <label for="species">Spesies *</label>
                    <select id="species" required>
                      <option value="">Pilih Spesies</option>
                      <option value="Sapi">Sapi</option>
                      <option value="Kambing">Kambing</option>
                      <option value="Domba">Domba</option>
                      <option value="Ayam">Ayam</option>
                      <option value="Bebek">Bebek</option>
                      <option value="Lainnya">Lainnya</option>
                    </select>
                  </div>
                </div>
            </div>

            <!-- Data Biometrik Section -->
            <div class="form-section">
              <h3>ğŸ“ Data Biometrik</h3>
              <div class="form-row">
                <div class="form-group">
                  <label for="breed">Ras/Breed</label>
                  <input type="text" id="breed" />
                </div>
                <div class="form-group">
                  <label for="gender">Jenis Kelamin *</label>
                  <select id="gender" required>
                    <option value="">Pilih Jenis Kelamin</option>
                    <option value="Jantan">Jantan</option>
                    <option value="Betina">Betina</option>
                  </select>
                </div>
              </div>
              
              <div class="form-row">
                <div class="form-group">
                  <label for="birthDate">Tanggal Lahir</label>
                  <input type="date" id="birthDate" />
                </div>
                <div class="form-group">
                  <label for="age">Umur (bulan)</label>
                  <input type="number" id="age" min="0" />
                </div>
              </div>

              <div class="form-row">
                <div class="form-group">
                  <label for="weight">Berat Awal (kg)</label>
                  <input type="number" id="weight" step="0.1" min="0" />
                </div>
                <div class="form-group">
                  <label for="height">Tinggi (cm)</label>
                  <input type="number" id="height" step="0.1" min="0" />
                </div>
              </div>

              <div class="form-row">
                <div class="form-group">
                  <label for="color">Warna Dominan</label>
                  <input type="text" id="color" />
                </div>
                <div class="form-group">
                  <label for="markings">Tanda Khusus</label>
                  <input type="text" id="markings" placeholder="Ciri khas, tatto, dll" />
                </div>
              </div>
            </div>

            <!-- Silsilah & Keturunan Section -->
            <div class="form-section">
              <h3>ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ Silsilah & Keturunan</h3>
              <div class="form-row">
                <div class="form-group">
                  <label for="parentMale">ID Pejantan (Ayah)</label>
                  <input type="text" id="parentMale" />
                </div>
                <div class="form-group">
                  <label for="parentFemale">ID Betina (Ibu)</label>
                  <input type="text" id="parentFemale" />
                </div>
              </div>
              
              <div class="form-group">
                <label for="generation">Generasi</label>
                <select id="generation">
                  <option value="">Pilih Generasi</option>
                  <option value="F0">F0 (Indukan)</option>
                  <option value="F1">F1 (Generasi 1)</option>
                  <option value="F2">F2 (Generasi 2)</option>
                  <option value="F3">F3 (Generasi 3)</option>
                </select>
              </div>
            </div>

            <!-- Lokasi & Status Section -->
            <div class="form-section">
              <h3>ğŸ“ Lokasi & Status</h3>
              <div class="form-row">
                <div class="form-group">
                  <label for="location">Lokasi Kandang</label>
                  <input type="text" id="location" />
                </div>
                <div class="form-group">
                  <label for="status">Status Hewan</label>
                  <select id="status">
                    <option value="Aktif">Aktif</option>
                    <option value="Sakit">Sakit</option>
                    <option value="Karantina">Karantina</option>
                    <option value="Dijual">Dijual</option>
                    <option value="Mati">Mati</option>
                  </select>
                </div>
              </div>

              <div class="form-group">
                <label for="purpose">Tujuan Pemeliharaan</label>
                <select id="purpose">
                  <option value="">Pilih Tujuan</option>
                  <option value="Pembibitan">Pembibitan</option>
                  <option value="Penggemukan">Penggemukan</option>
                  <option value="Perah">Perah</option>
                  <option value="Telur">Telur</option>
                  <option value="Kombinasi">Kombinasi</option>
                </select>
              </div>
            </div>

            <!-- Upload Dokumen Section -->
            <div class="form-section">
              <h3>ğŸ“„ Dokumen Pendukung</h3>
              <div class="document-upload">
                <div class="upload-area">
                  <input type="file" id="documents" multiple accept=".pdf,.jpg,.jpeg,.png" />
                  <label for="documents" class="upload-label">
                    ğŸ“ Upload Sertifikat, Foto, atau Dokumen Lainnya
                  </label>
                </div>
                <div id="uploadedFiles" class="file-list"></div>
              </div>
            </div>

            <!-- Catatan Section -->
            <div class="form-section">
              <h3>ğŸ“ Catatan Tambahan</h3>
              <div class="form-group">
                <label for="notes">Catatan</label>
                <textarea id="notes" rows="4" placeholder="Catatan khusus, riwayat kesehatan awal, dll"></textarea>
              </div>
            </div>

            <div class="form-actions">
              <button type="submit" class="btn btn-primary">
                ğŸ’¾ Simpan Data Hewan
              </button>
              <button type="reset" class="btn btn-secondary">
                ğŸ”„ Reset Form
              </button>
            </div>
          </form>
          </div>
        </div>

        <!-- Manajemen Data Sub Tab -->
        <div id="manajemen" class="sub-content">
          <div class="data-management">
            <div class="management-actions">
              <button class="btn btn-info" onclick="exportAllData()">
                ğŸ“¤ Export Data
              </button>
              <button class="btn btn-success" onclick="importData()">
                ğŸ“¥ Import Data
              </button>
              <button class="btn btn-warning" onclick="printAnimalList()">
                ğŸ–¨ï¸ Print Laporan
              </button>
            </div>
            
            <div class="data-overview">
              <h3>ğŸ“Š Ringkasan Data</h3>
              <div id="dataOverview" class="overview-cards">
                <!-- Will be populated by JavaScript -->
              </div>
            </div>
          </div>
        </div>

        <!-- Pencarian Sub Tab -->
        <div id="pencarian" class="sub-content">
          <div class="advanced-search">
            <h3>ğŸ” Pencarian & Filter Lanjut</h3>
            
            <!-- Search akan menggunakan modul yang sudah ada -->
            <div class="search-placeholder">
              <p>Gunakan tab <strong>ğŸ” Pencarian</strong> untuk fitur pencarian yang lebih lengkap</p>
              <button class="btn" onclick="showTab('search')">
                ğŸ” Buka Modul Pencarian
              </button>
            </div>
          </div>
        </div>
      </div>

      <!-- Search Tab -->
      <div id="search" class="tab-content">
        <div class="search-header">
          <h2>ğŸ” Pencarian Hewan</h2>
          <p class="search-subtitle">
            Temukan hewan dengan berbagai metode pencarian
          </p>
        </div>

        <!-- Search Methods Cards -->
        <div class="search-methods-grid">
          <div
            class="search-method-card active"
            onclick="switchSearchMethod('text')"
          >
            <div class="method-icon">ğŸ”</div>
            <div class="method-title">Pencarian Teks</div>
            <div class="method-description">
              Cari berdasarkan nama, spesies, atau atribut lainnya
            </div>
          </div>
          <div class="search-method-card" onclick="switchSearchMethod('id')">
            <div class="method-icon">ğŸ·ï¸</div>
            <div class="method-title">Input ID</div>
            <div class="method-description">Cari hewan dengan ID spesifik</div>
          </div>
          <div
            class="search-method-card"
            onclick="switchSearchMethod('barcode')"
          >
            <div class="method-icon">ğŸ“±</div>
            <div class="method-title">Scan Barcode</div>
            <div class="method-description">
              Gunakan kamera atau input manual
            </div>
          </div>
        </div>

        <!-- Search Containers -->
        <div class="search-content">
          <!-- Text Search -->
          <div id="textSearch" class="search-container active">
            <div class="search-input-wrapper">
              <div class="search-input-container">
                <div class="search-icon-wrapper">
                  <span class="search-icon">ğŸ”</span>
                </div>
                <input
                  type="text"
                  id="searchInput"
                  placeholder="Ketik nama hewan, spesies, ras, lokasi, atau warna..."
                  class="modern-input"
                />
                <div
                  class="search-clear"
                  onclick="clearSearch()"
                  style="display: none"
                >
                  âœ•
                </div>
              </div>
              <div class="search-suggestions">
                <span class="suggestion-label">Saran pencarian:</span>
                <div class="suggestion-tags">
                  <span class="suggestion-tag" onclick="quickSearch('kucing')"
                    >Kucing</span
                  >
                  <span class="suggestion-tag" onclick="quickSearch('anjing')"
                    >Anjing</span
                  >
                  <span class="suggestion-tag" onclick="quickSearch('sehat')"
                    >Status Sehat</span
                  >
                  <span class="suggestion-tag" onclick="quickSearch('jantan')"
                    >Jantan</span
                  >
                  <span class="suggestion-tag" onclick="quickSearch('betina')"
                    >Betina</span
                  >
                </div>
              </div>
            </div>
          </div>

          <!-- ID Search -->
          <div id="idSearch" class="search-container">
            <div class="search-input-wrapper">
              <div class="id-search-card">
                <div class="card-header">
                  <h3>ğŸ·ï¸ Pencarian berdasarkan ID</h3>
                  <p>Masukkan ID unik hewan untuk pencarian cepat</p>
                </div>
                <div class="search-input-container">
                  <div class="search-icon-wrapper">
                    <span class="search-icon">ğŸ·ï¸</span>
                  </div>
                  <input
                    type="number"
                    id="idInput"
                    placeholder="Contoh: 1, 2, 3..."
                    class="modern-input"
                    min="1"
                  />
                  <button class="search-btn" onclick="searchById()">
                    <span>Cari</span>
                    <div class="btn-ripple"></div>
                  </button>
                </div>
                <div class="id-examples">
                  <span class="example-label">ID Terakhir:</span>
                  <span class="example-id" id="lastIdExample">-</span>
                </div>
              </div>
            </div>
          </div>

          <!-- Barcode Scanner -->
          <div id="barcodeSearch" class="search-container">
            <div class="search-input-wrapper">
              <div class="barcode-scanner-card">
                <div class="card-header">
                  <h3>ğŸ“± Scanner Barcode</h3>
                  <p>Scan barcode atau masukkan kode secara manual</p>
                </div>

                <!-- Camera Scanner Section -->
                <div class="scanner-section">
                  <div class="scanner-controls">
                    <button
                      class="scanner-btn primary"
                      onclick="startBarcodeScanner()"
                    >
                      <span class="btn-icon">ğŸ“·</span>
                      <span>Mulai Scan Kamera</span>
                    </button>
                    <button
                      class="scanner-btn secondary"
                      onclick="stopBarcodeScanner()"
                    >
                      <span class="btn-icon">â¹ï¸</span>
                      <span>Stop Scanner</span>
                    </button>
                  </div>

                  <div id="scannerContainer" class="scanner-viewport">
                    <div class="scanner-frame">
                      <video id="video" autoplay playsinline></video>
                      <div class="scanner-overlay">
                        <div class="scanner-line"></div>
                        <div class="scanner-corners">
                          <div class="corner top-left"></div>
                          <div class="corner top-right"></div>
                          <div class="corner bottom-left"></div>
                          <div class="corner bottom-right"></div>
                        </div>
                      </div>
                    </div>
                    <canvas id="canvas" style="display: none"></canvas>
                    <p class="scanner-instruction">
                      Arahkan kamera ke barcode dan tunggu hingga terdeteksi
                    </p>
                  </div>
                </div>

                <!-- Scan Result -->
                <div id="scanResult" class="scan-result-card"></div>

                <!-- Manual Input Section -->
                <div class="manual-input-section">
                  <div class="section-divider">
                    <span class="divider-text">atau</span>
                  </div>

                  <div class="manual-input-card">
                    <h4>ğŸ“Š Input Manual Barcode</h4>
                    <div class="search-input-container">
                      <div class="search-icon-wrapper">
                        <span class="search-icon">ğŸ“Š</span>
                      </div>
                      <input
                        type="text"
                        id="barcodeInput"
                        placeholder="Masukkan 8 digit kode barcode..."
                        class="modern-input"
                        maxlength="8"
                      />
                      <button class="search-btn" onclick="searchByBarcode()">
                        <span>Cari</span>
                        <div class="btn-ripple"></div>
                      </button>
                    </div>
                    <div class="barcode-examples">
                      <span class="example-label">Format:</span>
                      <span class="example-code">00000001</span>
                      <span class="example-code">00000023</span>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Search Results -->
        <div id="searchResults" class="search-results-container"></div>
      </div>

      <!-- List Tab -->
      <div id="list" class="tab-content">
        <h2>Daftar Semua Hewan</h2>
        <div id="animalList"></div>
      </div>
    </div>

    <!-- Scripts -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jsbarcode/3.11.5/JsBarcode.all.min.js"></script>
    <script src="assets/js/utils.js"></script>
    <script src="assets/js/app.js"></script>
  </body>
</html>
